<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Movies search</title>
    <link rel="stylesheet" href="movieSearchApp.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div id="full">
      <header>
        <h1>search your movies here</h1>
      </header>
      <nav>
        <div class="searchDiv">
          <input type="text" id="searchInput" placeholder="search for a movie" />
          <!-- <button id="search
          Btn">Search Movie</button> -->
          <button type="button" class="btn btn-success">Search</button>
          <button
            class="homeBtn bg-primary text-white p-2"
            onclick="location.reload()"
            style="border: none"
          >
            Home
          </button>
        </div>
      </nav>
      <section>
        <div class="moviesBox">
          <div class="card text-dark" style="width: auto">
            <h5></h5>
            <div class="imgo">
              <img src="..." class="card-img-top" alt="..." />
            </div>
  
            <div class="card-body">
              <p class="card-text">
                Some quick example text to build on the card title and make up the
                bulk of the card's content.
              </p>
            </div>
          </div>
          <div class="card text-dark" style="width: auto">
            <h5></h5>
            <img src="..." class="card-img-top" alt="..." />
            <div class="card-body">
              <p class="card-text">
                Some quick example text to build on the card title and make up the
                bulk of the card's content.
              </p>
            </div>
          </div>
          <div class="card text-dark" style="width: auto">
            <h5></h5>
            <img src="..." class="card-img-top" alt="..." />
            <div class="card-body">
              <p class="card-text">
                Some quick example text to build on the card title and make up the
                bulk of the card's content.
              </p>
            </div>
          </div>
          <div class="card text-dark" style="width: auto">
            <h5></h5>
            <img src="" class="card-img-top" alt="..." />
            <div class="card-body">
              <p class="card-text">
                Some quick example text to build on the card title and make up the
                bulk of the card's content.
              </p>
            </div>
          </div>
          <div class="card text-dark" style="width: auto">
            <h5></h5>
            <img src="" class="card-img-top" alt="..." />
            <div class="card-body">
              <p class="card-text">
                Some quick example text to build on the card title and make up the
                bulk of the card's content.
              </p>
            </div>
          </div>
          <div class="card text-dark" style="width: auto">
            <h5></h5>
            <img src="" class="card-img-top" alt="..." />
            <div class="card-body">
              <p class="card-text">
                Some quick example text to build on the card title and make up the
                bulk of the card's content.
              </p>
            </div>
          </div>
        </div>

    </div>
   
    </section>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
      let section = document.querySelector("section");
      let h2 = document.querySelector("h2");
      let card = document.querySelectorAll(".card");

      document.querySelector("button").addEventListener("click", function () {
        let inputValue = document.getElementById("searchInput");
        let searchText = getApi(inputValue.value);
        inputValue.value = "";
        console.log(searchText);
      });

      async function getApi(movieName) {
        card.forEach((s) => {
          s.style.display = "none";
        });
        if (movieName !== "") {
          try {
            let apiKey = "2af7b824";
            let url = `https://www.omdbapi.com/?t=${movieName}&apikey=${apiKey}`;
            let respons = await axios.get(url);

            // console.log(respons.data);
            if (respons.data.Response === "False") {
              movieBox.style.display = "none";
              section.innerHTML = `<h1>not founded !</h1>`;
              return; // yeh bhut imp hai ye func ko rokta hai
            }
            section.innerHTML = `<div class="card" style="">
                  <img src="${respons.data.Poster}" class="card-img-top" alt="..." />
                  <div class="card-body">
                    <h4 class="card-text">
                     ${respons.data.Title}
                    </h4>
                    <p style="letter-spacing: -1px; font-size:12px">${respons.data.Year} </p>
                  </div>
                </div>`;

            let card = document.querySelector(".card");
            card.classList.add("created");
            console.log(respons.data);
          } catch (error) {
            section.innerHTML = `<h1>something went wrong</h1>`;
            console.log("error");
          }
        } else {
          section.innerHTML = `<h1>please enter a movie name</h1>`;
        }
      }
      // for movies

      async function moviesOjb() {
        let allcards = document.querySelectorAll(".card");
        let arr = [
          "sultan",
          "dangal",
          "singh is king",
          "the martian",
          "phir hera pheri",
          "the nun",
        ];
        let apiKey = "2af7b824";
        // let url = `https://www.omdbapi.com/?t=${movie}&apikey=${apiKey}`;
        // let respons = await axios.get(url);

        let movies = arr.map((item) => item);
        let urls = movies.map(
          (name) => `https://www.omdbapi.com/?t=${name}&apikey=${apiKey}`
        );

        let promises = urls.map((url) => axios.get(url));
        let result = await Promise.all(promises);

        let films = result.map((res) => {
          return {
            name: res.data.Title,
            poster: res.data.Poster,
            year: res.data.Year,
          };
        });
        // console.log(films[1].poster);
        // o[0].textContent = films[0].name;

        // let src = films[0].poster;
        // console.log(src);

        allcards.forEach((card, index) => {
          let img = card.querySelector("img");
          let h2 = card.querySelector("h5");
          let years = card.querySelector("p");

          if (films[index]) {
            img.setAttribute("src", films[index].poster);
            h2.textContent = films[index].name;
            years.textContent = films[index].year;
          }
        });
      }

      moviesOjb();
      // let img = e.querySelectorAll("img").forEach((img) => {
      //   console.log(img.src);
      //   let stp = img.getAttribute('src');

      // });
      // let allimages = allcards.map(item => item);
      // console.log(allimages)
      // let att = o[1].getAttribute("src");
      // console.log(src);
      // o[1].setAttribute("src", films[1].poster);
    </script>
  </body>
</html>
